<div class="urgent-container">
  <!-- Header -->
  <div class="urgent-header">
    <button class="back-button" (click)="goBack()">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Retour
    </button>
    <div class="urgent-badge">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      URGENCE
    </div>
  </div>

  <!-- Content -->
  <div class="urgent-content">
    <div class="title-section">
      <h1 class="main-title">Accès Cas Urgent</h1>
      <p class="subtitle">Accès immédiat aux informations vitales du patient</p>
    </div>

    <!-- Quick Access Card -->
    <div class="access-card quick-access-card">
      <div class="card-header">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <h2>Mode Inconscient - Accès Rapide</h2>
      </div>
      <p class="card-description">
        Utiliser la reconnaissance faciale ou biométrique pour identifier le patient en mode inconscient
      </p>
      <button class="scan-button" (click)="quickAccess()" [disabled]="isScanning">
        <svg *ngIf="!isScanning" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 4H6C4.89543 4 4 4.89543 4 6V8M16 4H18C19.1046 4 20 4.89543 20 6V8M8 20H6C4.89543 20 4 19.1046 4 18V16M16 20H18C19.1046 20 20 19.1046 20 18V16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
        </svg>
        <span *ngIf="isScanning" class="spinner"></span>
        {{ isScanning ? 'Scan en cours...' : 'Démarrer le scan biométrique' }}
      </button>
    </div>

    <!-- CIN Search Card -->
    <div class="access-card cin-search-card">
      <div class="card-header">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="2" y="6" width="20" height="12" rx="2" stroke="#3b82f6" stroke-width="2"/>
          <path d="M8 10H8.01M12 10H16M8 14H16" stroke="#3b82f6" stroke-width="2" stroke-linecap="round"/>
          <circle cx="8" cy="13" r="1" fill="#3b82f6"/>
        </svg>
        <h2>Recherche par CIN</h2>
      </div>
      <p class="card-description">
        Entrer le numéro CIN du patient pour accéder à son dossier médical
      </p>
      
      <div class="cin-input-group">
        <input 
          type="text" 
          [(ngModel)]="cin" 
          placeholder="Entrer CIN (8 chiffres)"
          maxlength="8"
          class="cin-input"
          (keypress)="$event.key >= '0' && $event.key <= '9' ? true : $event.preventDefault()"
        />
        <button class="search-button" (click)="searchByCin()" [disabled]="isLoading">
          <svg *ngIf="!isLoading" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="9" cy="9" r="6" stroke="currentColor" stroke-width="2"/>
            <path d="M14 14L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span *ngIf="isLoading" class="spinner-small"></span>
          {{ isLoading ? 'Recherche...' : 'Rechercher' }}
        </button>
      </div>
      
      <p *ngIf="errorMessage" class="error-message">{{ errorMessage }}</p>
    </div>

    <!-- Patient Information Card -->
    <div *ngIf="showPatientInfo" class="patient-info-card">
      <div class="patient-header">
        <div class="patient-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="patient-details">
          <h3>{{ patientName }}</h3>
          <p *ngIf="patientAge">{{ patientAge }}</p>
        </div>
        <div class="blood-type-badge">{{ bloodType }}</div>
      </div>

      <div class="vital-info">
        <h4>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#ef4444" stroke-width="2"/>
            <path d="M12 8V12L15 15" stroke="#ef4444" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Informations Vitales
        </h4>
        
        <div class="info-section">
          <strong>Allergies:</strong>
          <div class="tag-list">
            <span *ngFor="let allergy of medicalData.allergies" class="tag allergy-tag">{{ allergy }}</span>
          </div>
        </div>

        <div class="info-section">
          <strong>Maladies Chroniques:</strong>
          <div class="tag-list">
            <span *ngFor="let disease of medicalData.chronicDiseases" class="tag disease-tag">{{ disease }}</span>
          </div>
        </div>

        <div class="info-section">
          <strong>Médicaments en Cours:</strong>
          <div class="tag-list">
            <span *ngFor="let med of medicalData.currentMedications" class="tag medication-tag">{{ med }}</span>
          </div>
        </div>

        <div class="info-section">
          <strong>Contact d'Urgence:</strong>
          <button class="contact-button" (click)="callEmergencyContact()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M22 16.92V19.92C22 20.4728 21.5523 20.92 21 20.92C10.5066 20.92 2 12.4134 2 1.92002C2 1.36774 2.44772 0.920021 3 0.920021H6C6.55228 0.920021 7 1.36774 7 1.92002C7 3.97089 7.38604 5.92985 8.10061 7.73124C8.21103 8.01433 8.13705 8.33699 7.91421 8.55983L5.91421 10.5598C7.81421 14.3598 10.6142 17.1598 14.4142 19.0598L16.4142 17.0598C16.637 16.837 16.9597 16.763 17.2428 16.8734C19.0442 17.5879 21.0031 17.974 23.054 17.974C23.6063 17.974 24.054 18.4217 24.054 18.974L22 16.92Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            {{ medicalData.emergencyContact }}
          </button>
        </div>

        <div class="info-section">
          <strong>Dernière Visite:</strong>
          <span class="text-value">{{ medicalData.lastVisit }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
